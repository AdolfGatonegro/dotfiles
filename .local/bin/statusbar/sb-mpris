#!/bin/sh
case $BLOCK_BUTTON in
	1) playerctl play-pause; kill -47 $(pidof dwmblocks) ;;
	2) "$TERMINAL" -e "$EDITOR" "$0" ;;
	4) playerctl next; kill -47 $(pidof dwmblocks) ;;
	5) playerctl previous; kill -47 $(pidof dwmblocks) ;;
esac

if $(playerctl status > /dev/null 2>&1); then
	artist="$(playerctl metadata xesam:artist)"
	title="$(playerctl metadata xesam:title)"
	case $(playerctl status) in
		Stopped)
			colour=15
			icon="" ;;
		Paused)
			colour=10
			icon="" ;;
		Playing)
			colour=6
			icon="" ;;
	esac
	case $title in
		"") exit 0 ;;
		"Firefox is playing media")
			printf "%s  %s%s\\n" "^C$colour^$icon" "$title" "^C7^" ;;
		*)	# truncate "$title - $artist" to 48 characters to leave room
			# for the colour codes at the end
			printf "%s  %.48s%s\\n" "^C$colour^$icon" "$title - $artist" "^C7^" ;;
		esac
else
	exit 0
fi
